<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <meta name="description" content="">
    <meta name="google" value="notranslate">
    <meta name="author" content="Klokan Technologies GmbH (http://www.klokantech.com/)">
    <meta name="url" content="https://github.com/klokantech/iiifviewer">
    <link href="http://klokantech.github.io/styles/base.css" rel="stylesheet">
    <link href="../index.css" rel="stylesheet">
    <script type="text/javascript" src="http://klokantech.github.io/styles/js/index.js"></script>
    <title>IIIF Viewer | Draw and modify features</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.11.2/ol.min.js" type="text/javascript"></script>
    <script src="http://cdn.klokantech.com/iiifviewer/v1.1/ol-iiifviewer.js" type="text/javascript"></script>
  </head>
  <body>
    <div id="navbar-top-small">
      <div class="container">
        <div class="logo">
          <h1 style="padding-top: 10px;">
            <img src="../img/iiifviewer-logo-white.png">
            <a href="https://github.com/klokantech/iiifviewer">
              <strong>IIIF</strong> Viewer
            </a>
          </h1>
        </div>
        <ul class="nav">
          <li><a href="https://github.com/klokantech/iiifviewer">Github</a></li>
          <li><a href="http://www.klokantech.com/contact/">Contact</a></li>
        </ul>
        <div class="nav-mobile">
          <div id="nav-mobile-btn">#</div>
          <ul id="nav-mobile-nav">
            <li><a href="https://github.com/klokantech/iiifviewer">Github</a></li>
            <li><a href="http://www.klokantech.com/contact/">Contact</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="container main">
      <div class="row">
        <div class="col2">
          Available examples:
          <ul>
            <li><a href="index.html">Simple example</a></li>
            <li><a href="features.html">Draw and modify features</a></li>
            <li><a href="print.html">Print to PDF</a></li>
            <li><a href="permalink.html">Permalink</a></li>
          </ul>
        </div>
        <div class="col6">
          <h3>Draw and modify features example</h3>
          <div id="map" style="width:100%;height:400px;border:1px solid #000;"></div>
          <script type="text/javascript">
            var init = function(viewer) {
              var map = viewer.getMap();
              var collection = new ol.Collection();
              var featureOverlay = new ol.layer.Vector({
                map: map,
                source: new ol.source.Vector({
                  features: collection
                }),
                style: new ol.style.Style({
                  fill: new ol.style.Fill({color: 'rgba(255, 255, 255, 0.2)'}),
                  stroke: new ol.style.Stroke({color: '#ffcc33', width: 2}),
                  image: new ol.style.Circle({radius: 7, fill: new ol.style.Fill({color: '#ffcc33'})})
                })
              });

              var modify = new ol.interaction.Modify({
                features: collection,
                // the SHIFT key must be pressed to delete vertices, so
                // that new vertices can be drawn at the same position
                // of existing vertices
                deleteCondition: function(event) {
                  return ol.events.condition.shiftKeyOnly(event) &&
                          ol.events.condition.singleClick(event);
                }
              });
              map.addInteraction(modify);

              var draw; // global so we can remove it later
              function addInteraction() {
                draw = new ol.interaction.Draw({
                  features: collection,
                  type: typeSelect.value
                });
                map.addInteraction(draw);
              }

              var typeSelect = document.getElementById('type');
              typeSelect.onchange = function(e) {
                map.removeInteraction(draw);
                addInteraction();
              };

              addInteraction();
            };
            var url = location.hash.toString().substr(1);
            if (url.length < 2)
              url = 'http://iiif.klokantech.com/demo.jp2/info.json';
            new IiifViewer('map', url, init);
          </script>
        </div>
        <div class="col4">
          <form>
            <label>Geometry type:</label>
            <select id="type">
              <option value="Point">Point</option>
              <option value="LineString">LineString</option>
              <option value="Polygon" selected="selected">Polygon</option>
            </select>
          </form>
          <span style="font-size:0.7em;">Adapted from <a href="http://openlayers.org/en/master/examples/draw-and-modify-features.html">http://openlayers.org/en/master/examples/draw-and-modify-features.html</a>.</span>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="container pad-2">
        Copyright &copy; 2014 <a href="http://klokantech.com">Klokan Technologies GmbH</a>
      </div>
    </div>
  </body>
</html>
